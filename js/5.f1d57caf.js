(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"45e4":function(t,e,a){},"5ad4":function(t,e,a){"use strict";a("c57c")},"81c7":function(t,e,a){"use strict";a("45e4")},b4e3:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{attrs:{padding:""}},[a("div",{staticClass:"text-center text-h6"},[t._v("Settings")]),a("div",{staticClass:"q-pa-md"},[a("q-list",[a("q-item-label",{attrs:{header:""}},[t._v("Settings")]),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{tag:"label"}},[a("q-item-section",[a("q-item-label",[t._v("Dark Mode")])],1),a("q-item-section",{attrs:{avatar:""}},[a("q-toggle",{on:{input:function(e){return t.saveSettings()}},model:{value:t.settings.darkMode,callback:function(e){t.$set(t.settings,"darkMode",e)},expression:"settings.darkMode"}})],1)],1),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{tag:"label"}},[a("q-item-section",[a("q-item-label",[t._v("Note Editor Bottom Toolbar")])],1),a("q-item-section",{attrs:{avatar:""}},[a("q-toggle",{on:{input:function(e){return t.saveSettings()}},model:{value:t.settings.invertNoteEdit,callback:function(e){t.$set(t.settings,"invertNoteEdit",e)},expression:"settings.invertNoteEdit"}})],1)],1),a("q-separator",{attrs:{spaced:""}}),a("q-item-label",{attrs:{header:""}},[t._v("Backups")]),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{tag:"label"},on:{click:function(e){t.importWindowOpen=!0}}},[a("q-item-section",[a("q-item-label",[t._v("Import Backup")])],1)],1),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{tag:"label"},on:{click:function(e){t.exportWindowOpen=!0}}},[a("q-item-section",[a("q-item-label",[t._v("Export Backup")])],1)],1)],1)],1),a("q-dialog",{model:{value:t.importWindowOpen,callback:function(e){t.importWindowOpen=e},expression:"importWindowOpen"}},[a("ImportBackup")],1),a("q-dialog",{model:{value:t.exportWindowOpen,callback:function(e){t.exportWindowOpen=e},expression:"exportWindowOpen"}},[a("ExportBackup")],1)],1)},o=[],n=a("60a3"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card",{staticStyle:{width:"75vw"}},[a("q-card-section",[a("div",{staticClass:"text-h6 text-center"},[t._v("Import Backup")])]),a("q-card-section",{staticClass:"q-pa-md q-gutter-y-md"},[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{tag:"label"}},[a("q-item-section",[a("q-item-label",[t._v("Expose Raw Text")])],1),a("q-item-section",{attrs:{avatar:""}},[a("q-toggle",{model:{value:t.useText,callback:function(e){t.useText=e},expression:"useText"}})],1)],1),t.useText?a("q-item",{attrs:{tag:"label"}},[a("q-item-section",[a("q-item-label",[t._v("Backup Data")]),a("q-input",{attrs:{filled:"",type:"textarea"},model:{value:t.rawText,callback:function(e){t.rawText=e},expression:"rawText"}})],1)],1):t._e(),t.useText?t._e():a("q-file",{attrs:{outlined:"",label:"Select Backup File",accept:t.$q.platform.is.capacitor?"":".drb, .drb.json"},scopedSlots:t._u([{key:"append",fn:function(){},proxy:!0}],null,!1,2485212775),model:{value:t.file,callback:function(e){t.file=e},expression:"file"}},[a("q-icon",{attrs:{name:"attach_file"}})],1),a("q-card-actions",{attrs:{align:"around"}},[a("q-btn",{attrs:{disabled:!t.useText&&null==t.file||t.useText&&""==t.rawText,flat:""},on:{click:function(e){return t.readInputJson()}}},[t._v("Import Backup")]),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:""}},[t._v("Cancel")])],1)],1)],1)},s=[],l=a("f90c"),c=a.n(l),p=a("2b0e");const d=new p["a"];var u=d,f=function(t,e,a,i){var o,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,a,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(n<3?o(r):n>3?o(e,a,r):o(e,a))||r);return n>3&&r&&Object.defineProperty(e,a,r),r},m=function(t,e,a,i){function o(t){return t instanceof a?t:new a((function(e){e(t)}))}return new(a||(a=Promise))((function(a,n){function r(t){try{l(i.next(t))}catch(e){n(e)}}function s(t){try{l(i["throw"](t))}catch(e){n(e)}}function l(t){t.done?a(t.value):o(t.value).then(r,s)}l((i=i.apply(t,e||[])).next())}))};let v=class extends n["b"]{constructor(){super(...arguments),this.useText=!1,this.rawText="",this.file=null,this.mobileFileLabel=""}parseJsonDreams(t){let e=new Array,a=t;return void 0!=a&&(console.log("Parsing JSON :: "+JSON.stringify(a)),a[Object.keys(a).filter((t=>"SavedDates"==t))[0]].forEach((t=>{let i={date:t};i.dreams=a[Object.keys(a).filter((e=>e=="D"+t))[0]],i.note=a[Object.keys(a).filter((e=>e=="N"+t))[0]],e.push(i)})),console.log(e)),e}FileValidator(t){let e;return console.log(t),c.a.isBase64(t)?e=JSON.parse(atob(t)):c.a.isJSON(t)?e=JSON.parse(t):this.$q.notify({type:"negative",color:"danger",message:"Invalid format! Only DreamReader backups are readable."}),console.log(e),e}importSaveData(t){return m(this,void 0,void 0,(function*(){console.log(t);const e=this.FileValidator(t),a=this.$store.getters.getActiveDate,i=this.parseJsonDreams(e);yield i.forEach((t=>m(this,void 0,void 0,(function*(){console.log(JSON.stringify(t)+"--"+a),yield this.$store.dispatch("SetActiveDate",t.date),""==t.note&&null==t.note||(yield this.$store.dispatch("SaveNote",t.note)),t.dreams.forEach((e=>m(this,void 0,void 0,(function*(){const a=t.date;yield this.$store.dispatch("SaveDream",{id:e,date:a})})))),this.$q.loadingBar.increment(i.indexOf(t)/i.length)})))),this.$store.dispatch("SetActiveDate",a),this.$q.notify("Import Complete!"),u.$emit("closeImport")}))}readInputJson(){return m(this,void 0,void 0,(function*(){this.$q.loading.isActive=!0,this.$q.loadingBar.start();let t="";t=this.useText?this.rawText:yield this.file.text(),console.log(t),yield this.importSaveData(t),this.$q.loading.isActive=!1,this.$q.loadingBar.stop(),this.file=null}))}};v=f([n["a"]],v);var h=v,g=h,b=(a("5ad4"),a("2877")),x=a("f09f"),q=a("a370"),w=a("66e5"),y=a("4074"),k=a("0170"),S=a("9564"),O=a("27f9"),T=a("7d53"),$=a("0016"),_=a("4b7e"),Q=a("9c40"),D=a("8572"),I=a("714f"),N=a("7f67"),B=a("eebe"),j=a.n(B),E=Object(b["a"])(g,r,s,!1,null,null,null),C=E.exports;j()(E,"components",{QCard:x["a"],QCardSection:q["a"],QItem:w["a"],QItemSection:y["a"],QItemLabel:k["a"],QToggle:S["a"],QInput:O["a"],QFile:T["a"],QIcon:$["a"],QCardActions:_["a"],QBtn:Q["a"],QField:D["a"]}),j()(E,"directives",{Ripple:I["a"],ClosePopup:N["a"]});var J=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card",{staticStyle:{width:"75vw"}},[a("q-card-section"),a("div",{staticClass:"text-h6 text-center"},[t._v("Export Backup")]),a("q-card-section",{staticClass:"q-pa-md q-gutter-y-md"}),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{tag:"label"}},[a("q-item-section",[a("q-item-label",[t._v("Save as Base64")])],1),a("q-item-section",{attrs:{avatar:""}},[a("q-toggle",{model:{value:t.base64,callback:function(e){t.base64=e},expression:"base64"}})],1)],1),a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{tag:"label"}},[a("q-item-section",[a("q-item-label",[t._v("Expose Raw Text")])],1),a("q-item-section",{attrs:{avatar:""}},[a("q-toggle",{model:{value:t.useText,callback:function(e){t.useText=e},expression:"useText"}})],1)],1),t.useText?a("q-item",{attrs:{tag:"label"}},[a("q-item-section",[a("q-item-label",[t._v("Backup Data")]),a("q-input",{attrs:{filled:"",type:"textarea"},scopedSlots:t._u([{key:"append",fn:function(){},proxy:!0}],null,!1,2485212775),model:{value:t.rawText,callback:function(e){t.rawText=e},expression:"rawText"}},[a("q-icon",{attrs:{name:"content_copy",ripple:""},on:{click:function(e){return t.copyData()}}})],1)],1)],1):t._e(),a("q-card-actions",{attrs:{align:"around"}},[a("q-btn",{attrs:{flat:""},on:{click:function(e){return t.exportData()}}},[t._v("Save Backup")]),t.$q.platform.is.capacitor?a("q-btn",{attrs:{flat:""},on:{click:function(e){return t.exportData(!0)}}},[t._v("Save & Share")]):t._e(),t.$q.platform.is.capacitor?t._e():a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:""}},[t._v("Cancel")])],1)],1)},R=[],F=a("c1df"),P=a.n(F),W=a("a357"),M=a("cdde"),A=a("81c3"),L=function(t,e,a,i){var o,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,a,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(n<3?o(r):n>3?o(e,a,r):o(e,a))||r);return n>3&&r&&Object.defineProperty(e,a,r),r},Y=function(t,e,a,i){function o(t){return t instanceof a?t:new a((function(e){e(t)}))}return new(a||(a=Promise))((function(a,n){function r(t){try{l(i.next(t))}catch(e){n(e)}}function s(t){try{l(i["throw"](t))}catch(e){n(e)}}function l(t){t.done?a(t.value):o(t.value).then(r,s)}l((i=i.apply(t,e||[])).next())}))};let H=class extends n["b"]{constructor(){super(...arguments),this.base64=!1,this.rawText="",this.useText=!1}get localForage(){return this.$store.getters.getLocalForage}exportData(t=!1){return Y(this,void 0,void 0,(function*(){const e=yield this.outputJson();this.useText?this.rawText=e:this.downloadOutputJson(e,t)}))}outputJson(){return Y(this,void 0,void 0,(function*(){let t={};yield this.localForage.iterate(((e,a)=>{t[a]=e}));const e=JSON.stringify(t);return this.base64?btoa(e):e}))}downloadOutputJson(t,e=!1){return Y(this,void 0,void 0,(function*(){const a="DreamReader-"+P()().format("MM-DD-YYYY-HH-MM")+(this.base64?".drb":".drb.json"),i=this.base64?"text/plain":"application/json;charset=utf-8";if(this.$q.platform.is.capacitor&&(yield this.ShareExport(a,t,i,e)),this.$q.platform.is.desktop||this.$q.platform.is.electron){const e=Object(W["a"])(a,t,i);console.log(e)}}))}copyData(){return Y(this,void 0,void 0,(function*(){this.rawText=""!=this.rawText?this.rawText:yield this.outputJson(),Object(M["a"])(this.rawText).then((()=>{this.$q.notify("Copied!"),console.log("Copied")}))}))}ShareExport(t,e,a,i=!1){return Y(this,void 0,void 0,(function*(){console.log(e),yield A["b"].Filesystem.writeFile({path:"DreamReader/"+t,data:btoa(e),directory:A["a"].ExternalStorage,recursive:!0}),this.$q.platform.is.ios&&this.$q.notify({message:"File "+t+" exported to Documents folder",position:i?"top":"bottom",timeout:1e3}),this.$q.platform.is.android&&this.$q.notify({message:"File "+t+" exported to Local Storage",position:i?"top":"bottom",timeout:1e3}),i&&(yield A["b"].FileSharer.share({filename:t,base64Data:btoa(e),contentType:a}))}))}};H=L([n["a"]],H);var V=H,z=V,G=Object(b["a"])(z,J,R,!1,null,null,null),K=G.exports;j()(G,"components",{QCard:x["a"],QCardSection:q["a"],QItem:w["a"],QItemSection:y["a"],QItemLabel:k["a"],QToggle:S["a"],QInput:O["a"],QIcon:$["a"],QCardActions:_["a"],QBtn:Q["a"]}),j()(G,"directives",{Ripple:I["a"],ClosePopup:N["a"]});var U=function(t,e,a,i){var o,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,a):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,a,i);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(n<3?o(r):n>3?o(e,a,r):o(e,a))||r);return n>3&&r&&Object.defineProperty(e,a,r),r};let X=class extends n["b"]{constructor(){super(...arguments),this.settings={darkMode:!1,invertNoteEdit:!1},this.exportWindowOpen=!1,this.importWindowOpen=!1}created(){u.$on("closeExport",(()=>this.exportWindowOpen=!1)),u.$on("closeImport",(()=>this.importWindowOpen=!1))}mounted(){this.settings=this.$store.getters.getSettings}get localForage(){return this.$store.getters.getLocalForage}saveSettings(){this.$store.dispatch("SaveSettings",this.settings)}};X=U([Object(n["a"])({components:{ImportBackup:C,ExportBackup:K}})],X);var Z=X,tt=Z,et=(a("81c7"),a("9989")),at=a("1c1c"),it=a("eb85"),ot=a("24e8"),nt=Object(b["a"])(tt,i,o,!1,null,"51c95ecb",null);e["default"]=nt.exports;j()(nt,"components",{QPage:et["a"],QList:at["a"],QItemLabel:k["a"],QItem:w["a"],QItemSection:y["a"],QToggle:S["a"],QSeparator:it["a"],QDialog:ot["a"]}),j()(nt,"directives",{Ripple:I["a"]})},c57c:function(t,e,a){}}]);